---

title: ret2libc总结

date: 2025-11-07 22:03:38

tags:

---

```python

u64(p.recvuntil('\x7f')[-6:].ljust(8,b'\x00'))

```
  

* libc 动态地址通常在用户地址空间高位，其最高字节常为 `0x7f`（Linux x86\_64）。`recvuntil('\x7f')` 是常见的 heuristic：一直读取直到看到 `0x7f`（即地址结束字节）为止。

* `[-6:]`：因为 puts 打印地址通常会只输出低 6 个有效字节（高位为 0x00 0x00 0x7f），所以截 6 个字节就够了。然后 `ljust(8,b'\x00')` 填充到 8 个字节以便 `u64` 解析成 64-bit 小端整型。

* 结果就是 `puts_addr` 的真实值。